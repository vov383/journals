---
title: 선석작업현황 수정
created: 2024-04-18 09:05
aliases: 
tags:
---
- [x] 선박 안보이는 문제 해결 ✅ 2024-04-18
선석현황 배 그림 안 나오는 문제 수정 완료
- [x] 그림 그리는 로직 수정 ✅ 2024-05-29

그림그리는 로직 수정

이미지 경로 설정하고

이미지 가져와서


```cs
foreach (var berthInfo in _berthInfoDtosOrigin)
{   
    int mwNum = berthInfo.mwNum;
    ComBerthDto comBerthDto = berthInfo.ComBerthDto;
    string sh_cd = comBerthDto.SH_CD;
    BerthCommFilter shipFilter = null;
    if (sh_cd != null &&
        !string.IsNullOrEmpty(sh_cd))
    {
        shipFilter = new BerthCommFilter(comBerthDto);
    }
    string berthWorkKey = berthInfo.berthWorkKey;
    DockWorkDto dockWorkDto = null;
    List<UnloadWorkDto> ulWorkDtos = null;
    if (berthWorkKey != null &&
        !string.IsNullOrEmpty(berthWorkKey))
    {
        dockWorkDto = berthInfo.DockWorkDto;
        ulWorkDtos = berthInfo.UnloadWorkDtos;
    }

    for (int i = 0; i < _ucBerthInfos.Count; i++) // ucBerthInfo 유저 컨트롤 수만큼 반복
    {   
        if (mwNum == (i + 1)) // 선석번호가 i+1과 일치할 때만 실행되는 로직
        {
            if (berthWorkKey != null &&
        !string.IsNullOrEmpty(berthWorkKey))
            {
                ulWorkDtos = berthInfo.UnloadWorkDtos;
                if (ulWorkDtos != null && 
                    ulWorkDtos.Count > 0)
                {   
                    foreach (UnloadWorkDto ulWorkDto in ulWorkDtos)
                    {
                        dockWorkDto.AdditionalInfo["SHIP_HOLD_NUMBER"] = ulWorkDto.SH_HOLD;
                        dockWorkDto.AdditionalInfo["UL_CD"] = ulWorkDto.UL_CD;
                        dockWorkDto.AdditionalInfo["UL_NM"] = ulWorkDto.UL_NM;

                        for (int j = 0; j < _dock_num_list.Length; j++) // 계류장치 번호 담고 있는 int[] (배열)
                        {   
                            if (dockWorkDto.SH_DOCK_POS == (j + 1)) // 선박 접안 위치
                            {
                                if (dockWorkDto.SH_DOCK_POS <= 7)   // 6선석 부분 1 ~ 7번 계류장치
                                {
                                    if (dockWorkDto.SH_TURN_POS == 0) // turn_pos 0은 left
                                    {   
                                        for (int k = 1; k <= dockWorkDto.SH_HOLD; k++) // 홀드 1 ~ 11 반복
                                        {   
                                            int location_x = _dock_num_list[_dock_num_list.Length - 18 + (int)dockWorkDto.SH_DOCK_POS] + _ship_leftHead_num_start_list[dockWorkDto.SH_HOLD - 1]; // x의 좌표
                                            dockWorkDto.AdditionalInfo["HOLD_START_X"] = location_x;
                                            break;
                                        }
                                    }
                                    else if (dockWorkDto.SH_TURN_POS == 1) // turn_pos 1은 right
                                    {   
                                        for (int k = dockWorkDto.SH_HOLD; k >= 1; k--) // 홀드 11 ~ 1 거꾸로
                                        {
                                            int location_x = _dock_num_list[_dock_num_list.Length - 18 + (int)dockWorkDto.SH_DOCK_POS] + _ship_rightHead_num_start_list[dockWorkDto.SH_HOLD - 1];
                                            dockWorkDto.AdditionalInfo["HOLD_START_X"] = location_x;
                                            break;
                                        }
                                    }
                                }
                                else
                                {
                                    if (mwNum >= 4 && j + 1 >= 8 && j + 1 <= 17) //1선석과 6선석의 같은 계류장치 번호가 존재하여 판별을 위한 코드 // 선석코드가 4이상
                                    {
                                        if (dockWorkDto.SH_TURN_POS == 0)
                                        {
                                            for (int k = 1; k <= dockWorkDto.SH_HOLD; k++)
                                            {
                                                int location_x = _dock_num_list[_dock_num_list.Length - 17 + j] + _ship_leftHead_num_start_list[dockWorkDto.SH_HOLD - 1];
                                                dockWorkDto.AdditionalInfo["HOLD_START_X"] = location_x;
                                                break;
                                            }
                                        }
                                        else if (dockWorkDto.SH_TURN_POS == 1)
                                        {
                                            for (int k = dockWorkDto.SH_HOLD; k >= 1; k--)
                                            {
                                                int location_x = _dock_num_list[_dock_num_list.Length - 17 + j] + _ship_rightHead_num_start_list[dockWorkDto.SH_HOLD - 1];
                                                dockWorkDto.AdditionalInfo["HOLD_START_X"] = location_x;
                                                break;
                                            }
                                        }
                                    }
                                    else
                                    {
                                        if (dockWorkDto.SH_TURN_POS == 0)
                                        {
                                            for (int k = 1; k <= dockWorkDto.SH_HOLD; k++)
                                            {
                                                int location_x = _dock_num_list[j - 7] + _ship_leftHead_num_start_list[dockWorkDto.SH_HOLD - 1];
                                                dockWorkDto.AdditionalInfo["HOLD_START_X"] = location_x;
                                                break;
                                            }
                                        }
                                        else if (dockWorkDto.SH_TURN_POS == 1)
                                        {
                                            for (int k = dockWorkDto.SH_HOLD; k >= 1; k--)
                                            {
                                                int location_x = _dock_num_list[j - 7] + _ship_rightHead_num_start_list[dockWorkDto.SH_HOLD - 1];
                                                dockWorkDto.AdditionalInfo["HOLD_START_X"] = location_x;
                                                break;
                                            }
                                        }
                                    }
                                }
                            }
                        }
                        //ship_ht_list.Add(ship_ht);
                        //shipDnList.Add(DockWorkDn);
                        dockWorkDtosForPaint.Add(dockWorkDto);
                    }
                }

            }

        }
    }
}
```