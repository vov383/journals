---
title: 김선민 사원의 소스코드 설명
created: 2024-03-08 09:48
alias:
tags:
---
# 0306
### 오전
#### up선석배정계획.cs
##### AIResultBtn_Click()
ai 결과버튼 클릭
영상 제작용 메서드
오늘 오후에 영상촬영에 쓴 코드는 주석처리 해놓음
[[선석하역 코드 라이브러리]]

기본은 눌렀을 때
ai버튼 비활성화
색깔도 회색으로

##### clearVesselCalender()
메서드를 사용하여 캘린더 지우기
timer_cnt를 0으로 하고
커먼 클래스에서 프로그래스바 실행 
loading 스트링
5초
타이머 시작

##### Up선석배정계획_CellClick()
어떤 유저 컨트롤(uc선석배정계획`i`) 클릭했는지 판별하는 메서드
switch()문으로
1234
sheet_num  = 0, 1, 2, 3
해서 어떤 컨트롤 눌렸는지 확인

유저 컨트롤 바깥을 클릭했으면 벨류 ""

몇행 몇열인지 값 넣어줌

만약 해당 셀에 태그 없으면 벨류 ""

태그 있으면 그 셀에 태그번호 값 넣어줌

여기 통과했으면

if 좌클릭 우클릭 판별
우클릭이면 
if 셀 컬러가 비었으면
if col 이 홀수 주간, col이 짝수? 야간 정보 추가

수정 삭제 메뉴 활성화하기위해
Context 클래스 생성하고.
메뉴 아이템에 셀 정보, 닫기, 수정, 삭제 Add()
contextMenu.Show(this.부모, 마우스 포지션)
마우스 우클릭한 곳에 메뉴아이템이 생성되도록 함

##### contextMenu_UpdateBtn()
### 오후
### up선석배정계획.cs

캘린더 정보표시 

VesselInfo()

tb_dock_order
여기 담긴 선석 일정 가져옴
나중에 바뀌는 화면에는  tb_dock_order2 쓴다

넘어가는 일정 다 확인해서 일정 색칠하는 메서드

calenderDate()
이 메서드가 색칠해서 뿌려주는 메서드


VesselCalender_main()

FPSpread 기능 이미지 넣을 수 있음.
그런데 잘 안들어가서 점으로 넣을 수 있게
수정하면 머리에 o모양에 이미지 표시됨


시작일자
긑일자 변수

year 에 day 넣고 데이트타임객체

행 열 스프레드 저장하는 변수들
5개

스프레드 카운트로 판별
calStartDate

for for if
화면에 있는 일자랑
테이블에 있는 시작일자 종료일자를 계산
포함이 되면 각각 변수에 저장

근무조 주간 야간 체크해서 넣어주고
year = year.AddDays(1) 로 하루 더해줌

일자계산해서 맞는게 있으면 뿌려줌

포트(선석) 읽어와서 넣음
`.element["Port"]`

그 아래 if if for for
그 시트에만 일정이 있는지 넘어가는지 마지막 시트인지 체크
조건문
한 uc컨트롤 안에 있는지
그 전에 일자 저장해놓은걸 이용해서 값으로 해주는 조건문

그 아래 if if
글자 선석명 보여주는 if문
수정된 건지 여부도 보여준다 `.element["DT_UPDATE"]`

그 아래 else
길어서 다른 uc컨트롤로? 다른 시트로 넘어갈때
조건문 탄다.

else 이하 if 
캘린더 내에 일자가 존재하지 않을 경우

화면에 있는 일자 전에 있었던 계획이 있는 경우
판별하고 표시

else 이하 if if
화면 셀 밖으로 넘어가도 화면 안에만 칠해지도록
조건문에 들어가는 거 조금씩 다르니까 확인

if startSpread == k 면
then 컨트롤 하나를 넘어서 두번째 까지 길어지면 
사이에 있는 컨트롤도 선석 쭉 색칠되도록

시작일자면 선석만 표시




컨트롤 4에 있는데 4이상 넘어가지 않을때

맨 처음 시작 시트
그 다음 시트
그 다음 시트(마지막 까지 길어지면)


종료시트 일 때만 else 이하 블럭을 탄다



---
##### getVesselInfo()
선석배정 계획(tb_dock_order)이 있는 거 db  가져오는거
나중에는 (dock_order2 쓸거임

---

fps 셀 더블클릭 
입항예정정보 하단에 스프레드에서
이 셀을 더블클릭하면?
클릭된 셀에 있는 데이터를 가져와
sql로 옮겨서 세부사항을 가져와

ds 가져왔으면
해시 테이블에 저장하고
아래에서 fps 2번 셀에 add해서 뿌려줌


두번째 if는 입항예정정보가 있는데
이미 지정된 선박을 또 넣으려고 하면 중복된 선박이 있습니다 메시지


그 다음 if
6개 넘어가면
3번째 스프레드시트에 6row 이상 늘어나게
해시테이블리스트에 담긴 카운트를 계산해서 > 6 이면 생긴다.
스크롤 생김

컬럼너비 맞춰줌


선박 명을 뿌려줌
선박코드 컬럼(셀)이 하나 더 옆에 있는데 숨겨놓음
선박코드 적혀있어서 데이터만 나중에 쓸거임

port_entry_ai_list에 한 묶음으로 만들어줌



AI_result_Cell_DoubleClick
ai 결과에 쓰일 선박에서 필요없는 걸 더블클릭하면 ai_list에서 빠진다.

5번 스프레드 셀 데이터 가져와서
ai_list에 정보랑 같으면 리무브
5q번 셀에서도 리무브

6칸이면 그 셀 row를 지우고 밑에 새로운 빈 row 만들어
6칸 이상이면 row 를 전부 지움

속성 맞춰주고
리스트에서 빼버리고
뷰포인트를 맨 위에 쳐다보게 SetViewpoint

open_up하여계획_Click();
Common.ChangePage(this."5");
좌상단 하역계획 버튼 누르면 페이지 이동 기능하는 메서드
tb_com_menu 테이블에 정의되어 있음.
MENU_ID 가 2번 파라메터



fpSpread3_TextTipFetch()
2번 스프레드?
여기에 들어있는 정보 위에 호버하면
툴팁으로 드래그해서 추가할 수 있다고 조업자에게 지시하려고 만들었다.




tb_com_menu

tb_com_setup

tb_com_user

tb_com_berth? 선박 제원?? 모름 머임





입항예정정보에서 





##### chasu 컬럼
차수가 뭐임?
해당 선박이 몇번 들어왔는지

##### 용어정리 파일
경로
```dir
\\192.168.0.20\국가연구과제\중기부 스마트 제조혁신 과제\02. 설계관리\02. 설계\04.데이터베이스 설계\\중기부 스마트 제조혁신 과제 표준화 조업 데이터베이스 설계 v2.9.8
```
복사해서 로컬에서 열것

바뀐거 있을 때 확인
상세 정보는 하역관리 들어가면 나와있다.


내일은 디비 관련 설명

금요일 날 리뷰
선석배정이 뭔지
용어공부
공정에 대한 공부가 필요할듯

선석 : 
광양제철소 공정과정 파일
```dir
\\192.168.0.20\국가연구과제\중기부 스마트 제조혁신 과제\02. 설계관리\01. 분석\01.제철공정과정
```
선석배정은 없네

##### 선석배정 하역계획 화면 이유, 김선민 사원
![[journals/temp/선석배정 하역계획 화면 이유, 김선민 사원]]


